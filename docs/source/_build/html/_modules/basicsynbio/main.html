
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>basicsynbio.main &#8212; basicsynbio 0.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for basicsynbio.main</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Main module for basicsynbio.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">basicsynbio.utils</span> <span class="kn">import</span> <span class="n">_easy_seqrec</span>
<span class="kn">from</span> <span class="nn">basicsynbio.decorators</span> <span class="kn">import</span> <span class="n">add2docs</span>
<span class="kn">from</span> <span class="nn">Bio</span> <span class="kn">import</span> <span class="n">SeqUtils</span><span class="p">,</span> <span class="n">SeqIO</span>
<span class="kn">from</span> <span class="nn">Bio.Alphabet</span> <span class="kn">import</span> <span class="n">IUPAC</span>
<span class="kn">from</span> <span class="nn">Bio.Restriction.Restriction</span> <span class="kn">import</span> <span class="n">BsaI</span>
<span class="kn">from</span> <span class="nn">Bio.Seq</span> <span class="kn">import</span> <span class="n">Seq</span>
<span class="kn">from</span> <span class="nn">Bio.SeqRecord</span> <span class="kn">import</span> <span class="n">SeqRecord</span>
<span class="kn">from</span> <span class="nn">Bio.SeqFeature</span> <span class="kn">import</span> <span class="n">SeqFeature</span><span class="p">,</span> <span class="n">FeatureLocation</span>
<span class="kn">from</span> <span class="nn">Bio.SeqUtils.CheckSum</span> <span class="kn">import</span> <span class="n">seguid</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">DATE</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">DEFAULT_ANNOTATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;synthetic construct&quot;</span><span class="p">,</span>
    <span class="s2">&quot;organism&quot;</span><span class="p">:</span> <span class="s2">&quot;synthetic construct&quot;</span><span class="p">,</span>
    <span class="s2">&quot;taxonomy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;other sequences&quot;</span><span class="p">,</span> <span class="s2">&quot;artificial sequences&quot;</span><span class="p">],</span>
    <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">DATE</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">DATE</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%b&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">DATE</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;-%Y&quot;</span><span class="p">),</span>
    <span class="s2">&quot;accessions&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;sequence_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;topology&quot;</span><span class="p">:</span> <span class="s2">&quot;circular&quot;</span>
<span class="p">}</span>
<span class="n">IP_STR</span> <span class="o">=</span> <span class="s2">&quot;TCTGGTGGGTCTCTGTCC&quot;</span>
<span class="n">IS_STR</span> <span class="o">=</span> <span class="s2">&quot;GGCTCGGGAGACCTATCG&quot;</span>
<span class="n">IP_SEQREC</span> <span class="o">=</span> <span class="n">_easy_seqrec</span><span class="p">(</span><span class="n">IP_STR</span><span class="p">,</span> <span class="s2">&quot;iP&quot;</span><span class="p">,</span> <span class="n">note</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;BASIC integrated prefix&quot;</span><span class="p">])</span>
<span class="n">IS_SEQREC</span> <span class="o">=</span> <span class="n">_easy_seqrec</span><span class="p">(</span><span class="n">IS_STR</span><span class="p">,</span> <span class="s2">&quot;iS&quot;</span><span class="p">,</span> <span class="n">note</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;BASIC integrated suffix&quot;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">CommonArgDocs</span><span class="p">:</span>
    <span class="n">ADD_I_SEQS</span> <span class="o">=</span> <span class="s2">&quot;:param bool add_i_seqs: if True adds flanking BASIC iP and iS sequences. Note, letter_annotations attribute is lost.&quot;</span>
    <span class="n">HANDLE</span> <span class="o">=</span> <span class="s2">&quot;:param handle: handle to file.&quot;</span>
    <span class="n">FORMAT</span> <span class="o">=</span> <span class="s2">&quot;:param string format: file format.&quot;</span>
    <span class="n">ALPHABET</span> <span class="o">=</span> <span class="s2">&quot;:param Bio.Alphabet alphabet: Refer to Bio.Alphabet documentation.&quot;</span>
    <span class="n">SEQREC_KWARGS</span> <span class="o">=</span> <span class="s2">&quot;:param \**kwargs: assigns alternative SeqRecord attributes.&quot;</span>
    <span class="n">PARTS_LINKERS_ARGS</span> <span class="o">=</span> <span class="s2">&quot;:param \*parts_linkers: :py:class:`BasicPart` and :py:class:`BasicLinker` objects.&quot;</span>


<div class="viewcode-block" id="BasicPart"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicPart">[docs]</a><span class="k">class</span> <span class="nc">BasicPart</span><span class="p">(</span><span class="n">SeqRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for BASIC DNA assembly parts.</span>

<span class="sd">    A DNA sequence joined with other BasicParts via :py:class:`BasicLinker` instances when initialising :py:class:`BasicAssembly` objects. All sequences must contain intergated prefix and suffix sequences.</span>

<span class="sd">    :param seq: Refer to Bio.SeqRecord.SeqRecord documentation.</span>
<span class="sd">    :param string id: Refer to Bio.SeqRecord.SeqRecord documentation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ip_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_iseq</span><span class="p">(</span>
            <span class="n">IP_STR</span><span class="p">,</span> <span class="s2">&quot;iP sequence&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_loc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_iseq</span><span class="p">(</span>
            <span class="n">IS_STR</span><span class="p">,</span> <span class="s2">&quot;iS sequence&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_bsai</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_basic_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:return: seqrecord flanked by BASIC iP &amp; iS sequences.</span>
<span class="sd">        </span>
<span class="sd">        :rtype: Bio.SeqRecord.SeqRecord</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">returned_seqrec</span> <span class="o">=</span> <span class="n">SeqRecord</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">returned_seqrec</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">returned_seqrec</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ip_loc</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_loc</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">returned_seqrec</span><span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ip_loc</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">IP_STR</span><span class="p">):</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_loc</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ip_loc</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_loc</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">returned_seqrec</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_ip_loc</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">IP_STR</span><span class="p">):]</span> <span class="o">+</span> <span class="n">returned_seqrec</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_loc</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;incorrect sequence used.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_iseq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">iseq_str</span><span class="p">,</span> <span class="n">iseq_id</span><span class="o">=</span><span class="s2">&quot;integrated sequence&quot;</span><span class="p">):</span>
        <span class="n">search_out</span> <span class="o">=</span> <span class="n">SeqUtils</span><span class="o">.</span><span class="n">nt_search</span><span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">),</span> <span class="n">iseq_str</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_out</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PartException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> lacks </span><span class="si">{</span><span class="n">iseq_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">search_out</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PartException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> contains multiple </span><span class="si">{</span><span class="n">iseq_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">search_out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_check_bsai</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks if sliced BasicPart contains a BsaI site.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">BsaI</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PartException</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> contains more than two BsaI sites.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasicPart</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2"> is not a BasicPart instance.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span> <span class="ow">and</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
        <span class="p">)</span></div>


<span class="n">BasicPart</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">SEQREC_KWARGS</span>


<div class="viewcode-block" id="BasicLinker"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicLinker">[docs]</a><span class="k">class</span> <span class="nc">BasicLinker</span><span class="p">(</span><span class="n">SeqRecord</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for BASIC DNA assembly linkers.</span>

<span class="sd">    A DNA sequence joined with other BasicLinkers via :py:class:`BasicPart` instances when initialising :py:class:`BasicAssembly` objects.</span>

<span class="sd">    :param seq: Refer to Bio.SeqRecord.SeqRecord documentation.</span>
<span class="sd">    :param string id: Refer to Bio.SeqRecord.SeqRecord documentation.</span>
<span class="sd">    :param string prefix_id: ID for prefix linker half.</span>
<span class="sd">    :param string suffix_id: ID for suffix linker half.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">prefix_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_linker_half_id</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="n">prefix_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suffix_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_assign_linker_half_id</span><span class="p">(</span><span class="s2">&quot;suffix&quot;</span><span class="p">,</span> <span class="n">suffix_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linker_feature</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">basic_slice</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">_linker_feature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">SeqFeature</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;misc_feature&quot;</span><span class="p">,</span>
                <span class="n">location</span><span class="o">=</span><span class="n">FeatureLocation</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">),</span> <span class="n">strand</span><span class="o">=+</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">qualifiers</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)]</span>
                <span class="p">}</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assign_linker_half_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linker_half</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">id</span> <span class="ow">and</span> <span class="n">linker_half</span> <span class="o">==</span> <span class="s2">&quot;prefix&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">-P&quot;</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">id</span> <span class="ow">and</span> <span class="n">linker_half</span> <span class="o">==</span> <span class="s2">&quot;suffix&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">-S&quot;</span>
        <span class="k">return</span> <span class="nb">id</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">BasicLinker</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2"> is not a BasicLinker instance.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span> <span class="ow">and</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">seq</span><span class="p">)</span>
        <span class="p">)</span></div>


<span class="n">BasicLinker</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">SEQREC_KWARGS</span>


<div class="viewcode-block" id="BasicUTRRBSLinker"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicUTRRBSLinker">[docs]</a><span class="k">class</span> <span class="nc">BasicUTRRBSLinker</span><span class="p">(</span><span class="n">BasicLinker</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sub-class of :py:class:`BasicLinker` for UTR-RBS linkers.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">prefix_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">suffix_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">prefix_id</span><span class="p">,</span> <span class="n">suffix_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prefix_id</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_assign_linker_half_id</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">,</span> <span class="n">prefix_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suffix_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;UTR</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">-S&quot;</span></div>


<div class="viewcode-block" id="BasicAssembly"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicAssembly">[docs]</a><span class="k">class</span> <span class="nc">BasicAssembly</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Class for BASIC DNA assemblies.</span>

<span class="sd">    BasicAssembly class requires alternating :py:class:`BasicPart` and :py:class:`BasicLinker` instances in any order.</span>

<span class="sd">    :param string id: Identifier for BasicAssemby object. Must be unique amongst BasicAssembly instances used to initiate a BasicBuild object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">parts_linkers</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;id parsed to BasicAssembly constructor was not of type str.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span> <span class="o">=</span> <span class="n">parts_linkers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_reactions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_clip_reactions</span><span class="p">()</span>

<div class="viewcode-block" id="BasicAssembly.return_part"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicAssembly.return_part">[docs]</a>    <span class="nd">@add2docs</span><span class="p">(</span>
        <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">ALPHABET</span><span class="p">,</span>
        <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">SEQREC_KWARGS</span><span class="p">,</span>
        <span class="n">indentation</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">return_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">IUPAC</span><span class="o">.</span><span class="n">ambiguous_dna</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assembled construct as a new part.</span>

<span class="sd">        :rtype: :py:class:`BasicPart`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">seqrec2part</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">return_seqrec</span><span class="p">(</span><span class="n">alphabet</span><span class="o">=</span><span class="n">alphabet</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span></div>

<div class="viewcode-block" id="BasicAssembly.return_seqrec"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicAssembly.return_seqrec">[docs]</a>    <span class="nd">@add2docs</span><span class="p">(</span>
        <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">ALPHABET</span><span class="p">,</span>
        <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">SEQREC_KWARGS</span><span class="p">,</span>
        <span class="n">indentation</span><span class="o">=</span><span class="mi">8</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">return_seqrec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">IUPAC</span><span class="o">.</span><span class="n">ambiguous_dna</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assembled construct as a seqrecord.</span>

<span class="sd">        :rtype: Bio.SeqRecord.SeqRecord</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">seqrec</span> <span class="o">=</span> <span class="n">SeqRecord</span><span class="p">(</span><span class="n">Seq</span><span class="p">(</span><span class="nb">str</span><span class="p">()))</span>
        <span class="k">for</span> <span class="n">part_linker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">:</span>
            <span class="n">seqrec</span> <span class="o">+=</span> <span class="n">part_linker</span><span class="o">.</span><span class="n">basic_slice</span><span class="p">()</span>
        <span class="n">seqrec</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="n">seqrec</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;BASIC_construct_&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="n">seqrec</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;BASIC DNA Assembly of </span><span class="si">{</span><span class="p">[</span><span class="n">part_linker</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">part_linker</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">seqrec</span><span class="o">.</span><span class="n">annotations</span> <span class="o">=</span> <span class="n">DEFAULT_ANNOTATIONS</span>
        <span class="n">seqrec</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">seqrec</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">seqrec</span></div>

<div class="viewcode-block" id="BasicAssembly.return_clip_reactions"><a class="viewcode-back" href="../../api.html#basicsynbio.main.BasicAssembly.return_clip_reactions">[docs]</a>    <span class="k">def</span> <span class="nf">return_clip_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:py:class:`ClipReaction` instances required for BASIC assembly.</span>

<span class="sd">        :rtype: A tuple of ClipReactions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clip_reactions</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">part_linker</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">part_linker</span><span class="p">),</span> <span class="n">BasicLinker</span><span class="p">):</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">suffix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">suffix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">[</span><span class="n">ind</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">clip_reactions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">ClipReaction</span><span class="p">(</span>
                        <span class="n">prefix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parts_linkers</span><span class="p">[</span><span class="n">ind</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">part</span><span class="o">=</span><span class="n">part_linker</span><span class="p">,</span>
                        <span class="n">suffix</span><span class="o">=</span><span class="n">suffix</span>
                    <span class="p">)</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_clip_reactions</span><span class="p">(</span><span class="n">clip_reactions</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">clip_reactions</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_clip_reactions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clip_reactions</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks clip reactions are compatible e.g. same half linker not used</span>
<span class="sd">        multiple times.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_check_linker_halves</span><span class="p">(</span><span class="n">linker_halves</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Check linker_havles are compatible.</span>

<span class="sd">            Note UTR linker-halves must be compatible.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">linker_halves</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">linker_halves</span><span class="p">)):</span>
                <span class="n">top_linker_half</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">linker_halves</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">raise</span> <span class="n">AssemblyException</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;BasicAssembly initiated with </span><span class="si">{</span><span class="n">top_linker_half</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> used </span><span class="si">{</span><span class="n">top_linker_half</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> times.&quot;</span><span class="p">)</span>

        <span class="n">prefix_linkers</span> <span class="o">=</span> <span class="p">[</span><span class="n">clip_reaction</span><span class="o">.</span><span class="n">linker_half_ids</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">clip_reaction</span> <span class="ow">in</span> <span class="n">clip_reactions</span><span class="p">]</span>
        <span class="n">_check_linker_halves</span><span class="p">(</span><span class="n">prefix_linkers</span><span class="p">)</span>
        <span class="n">suffix_linkers</span> <span class="o">=</span> <span class="p">[</span><span class="n">clip_reaction</span><span class="o">.</span><span class="n">linker_half_ids</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                          <span class="k">for</span> <span class="n">clip_reaction</span> <span class="ow">in</span> <span class="n">clip_reactions</span><span class="p">]</span>
        <span class="n">_check_linker_halves</span><span class="p">(</span><span class="n">suffix_linkers</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">parts_linkers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parts_linkers</span>

    <span class="nd">@parts_linkers</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">parts_linkers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span>
                <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">BasicPart</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">BasicLinker</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Not all *parts_linkers are BasicParts or BasicLinkers instances.&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">ind</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">AssemblyException</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Alternating BasicPart, BasicLinker instances required: </span><span class="si">{</span><span class="n">value</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2"> is preceeded by </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">ind</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2"> and is of type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AssemblyException</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BasicAssembly instance with id:</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, initiated with an odd number of BasicPart/BasicLinker objects. An even number is a requirement.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parts_linkers</span> <span class="o">=</span> <span class="n">values</span></div>


<span class="n">BasicAssembly</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">+=</span> <span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">PARTS_LINKERS_ARGS</span>


<div class="viewcode-block" id="ClipReaction"><a class="viewcode-back" href="../../api.html#basicsynbio.main.ClipReaction">[docs]</a><span class="k">class</span> <span class="nc">ClipReaction</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Class for describing clip reactions. Note ClipReaction is hashable.</span>

<span class="sd">    :param BasicLinker prefix: :py:class:`BasicLinker` used as prefix in clip reaction.</span>
<span class="sd">    :param BasicPart part: :py:class:`BasicPart` used as part in clip reaction.</span>
<span class="sd">    :param BasicLinker suffix: :py:class:`BasicLinker` used as suffix in clip reaction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">part</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">=</span> <span class="n">prefix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span> <span class="o">=</span> <span class="n">suffix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_part</span> <span class="o">=</span> <span class="n">part</span>

<div class="viewcode-block" id="ClipReaction.linker_half_ids"><a class="viewcode-back" href="../../api.html#basicsynbio.main.ClipReaction.linker_half_ids">[docs]</a>    <span class="k">def</span> <span class="nf">linker_half_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:return: ids for prefix and suffix linkers in the form (prefix_id, suffix_id).</span>
<span class="sd">        </span>
<span class="sd">        :rtype: tuple(string, string)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="o">.</span><span class="n">prefix_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span><span class="o">.</span><span class="n">suffix_id</span></div>

<div class="viewcode-block" id="ClipReaction.clip_items"><a class="viewcode-back" href="../../api.html#basicsynbio.main.ClipReaction.clip_items">[docs]</a>    <span class="k">def</span> <span class="nf">clip_items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:return: (prefix, part, suffix).</span>

<span class="sd">        :rtype: tuple(BasicLinker, BasicPart, BasicLinker)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_part</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span></div>

    <span class="k">def</span> <span class="nf">_hexdigest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="s2">&quot;big&quot;</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;:return: the hexadecimal digest of the Clip Reaction md5 hash by converting it to a byte array. See docs on built-in function: int.to_bytes().&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__hash__</span><span class="p">()</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">byteorder</span><span class="o">=</span><span class="n">byteorder</span><span class="p">,</span> <span class="n">signed</span><span class="o">=</span><span class="n">signed</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_part</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span><span class="o">.</span><span class="n">id</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ClipReaction</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s2"> is not a ClipReaction instance.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_prefix</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_part</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_part</span> <span class="ow">and</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_suffix</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="PartException"><a class="viewcode-back" href="../../api.html#basicsynbio.main.PartException">[docs]</a><span class="k">class</span> <span class="nc">PartException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="LinkerException"><a class="viewcode-back" href="../../api.html#basicsynbio.main.LinkerException">[docs]</a><span class="k">class</span> <span class="nc">LinkerException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="AssemblyException"><a class="viewcode-back" href="../../api.html#basicsynbio.main.AssemblyException">[docs]</a><span class="k">class</span> <span class="nc">AssemblyException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="seqrec2part"><a class="viewcode-back" href="../../api.html#basicsynbio.main.seqrec2part">[docs]</a><span class="nd">@add2docs</span><span class="p">(</span><span class="n">CommonArgDocs</span><span class="o">.</span><span class="n">ADD_I_SEQS</span><span class="p">,</span> <span class="n">indentation</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">seqrec2part</span><span class="p">(</span><span class="n">seqrec</span><span class="p">,</span> <span class="n">add_i_seqs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert SeqRecord to :py:class:`BasicPart`.</span>

<span class="sd">    Relevant attributes are maintained.</span>

<span class="sd">    :param seqrec: SeqRecord to be converted to :py:class:`BasicPart` subclass.</span>
<span class="sd">    :type seqrec: Bio.SeqRecord.SeqRecord</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">add_i_seqs</span><span class="p">:</span>
        <span class="n">new_seqrec</span> <span class="o">=</span> <span class="n">IP_SEQREC</span> <span class="o">+</span> <span class="n">seqrec</span> <span class="o">+</span> <span class="n">IS_SEQREC</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">BasicPart</span><span class="p">(</span><span class="n">new_seqrec</span><span class="o">.</span><span class="n">seq</span><span class="p">,</span> <span class="n">seqrec</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                         <span class="n">features</span><span class="o">=</span><span class="n">new_seqrec</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">seqrec</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;_seq&quot;</span><span class="p">,</span> <span class="s2">&quot;_per_letter_annotations&quot;</span><span class="p">,</span> <span class="s2">&quot;features&quot;</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">part</span> <span class="o">=</span> <span class="n">BasicPart</span><span class="p">(</span><span class="n">seqrec</span><span class="o">.</span><span class="n">seq</span><span class="p">,</span> <span class="n">seqrec</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">seqrec</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">part</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">part</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">basicsynbio</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, London Biofoundry.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>